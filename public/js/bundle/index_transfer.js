(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{1114:function(t,e,s){"use strict";s.r(e);var r=s(4),a=s(0),n=s.n(a),i=s(8);s(17);function o(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?o(Object(s),!0).forEach((function(e){c(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):o(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}function c(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var u={metaInfo:{title:"Transfer"},data:function(){return{isLoading:!0,serverParams:{sort:{field:"id",type:"desc"},page:1,perPage:10},selectedIds:[],search:"",totalRows:"",loading:!0,spinner:!1,limit:"10",Filter_date:"",Filter_status:"",Filter_Ref:"",Filter_From:"",Filter_To:"",details:[],warehouses:[],transfers:[],transfer:{GrandTotal:""}}},computed:l(l({},Object(r.c)(["currentUserPermissions","currentUser"])),{},{columns:function(){return[{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Reference"),field:"Ref",tdClass:"text-left",thClass:"text-left"},{label:this.$t("FromWarehouse"),field:"from_warehouse",tdClass:"text-left",thClass:"text-left"},{label:this.$t("ToWarehouse"),field:"to_warehouse",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Items"),field:"items",type:"decimal",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Total"),field:"GrandTotal",type:"decimal",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Status"),field:"statut",html:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Action"),field:"actions",html:!0,tdClass:"text-right",thClass:"text-right",sortable:!1}]}}),methods:{updateParams:function(t){this.serverParams=Object.assign({},this.serverParams,t)},onPageChange:function(t){var e=t.currentPage;this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Transfers(e))},onPerPageChange:function(t){var e=t.currentPerPage;this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Transfers(1))},selectionChanged:function(t){var e=this,s=t.selectedRows;this.selectedIds=[],s.forEach((function(t,s){e.selectedIds.push(t.id)}))},onSortChange:function(t){var e="";e="from_warehouse"==t[0].field?"from_warehouse_id":"to_warehouse"==t[0].field?"to_warehouse_id":t[0].field,this.updateParams({sort:{type:t[0].type,field:e}}),this.Get_Transfers(this.serverParams.page)},onSearch:function(t){this.search=t.searchTerm,this.Get_Transfers(this.serverParams.page)},setToStrings:function(){null===this.Filter_From?this.Filter_From="":null===this.Filter_To?this.Filter_To="":null===this.Filter_status&&(this.Filter_status="")},formatNumber:function(t,e){var s=("string"==typeof t?t:t.toString()).split(".");if(e<=0)return s[0];var r=s[1]||"";if(r.length>e)return"".concat(s[0],".").concat(r.substr(0,e));for(;r.length<e;)r+="0";return"".concat(s[0],".").concat(r)},Reset_Filter:function(){this.search="",this.Filter_date="",this.Filter_status="",this.Filter_Ref="",this.Filter_From="",this.Filter_To="",this.Get_Transfers(this.serverParams.page)},Get_Transfers:function(t){var e=this;n.a.start(),n.a.set(.1),this.setToStrings(),axios.get("transfers?page="+t+"&Ref="+this.Filter_Ref+"&statut="+this.Filter_status+"&from_warehouse_id="+this.Filter_From+"&to_warehouse_id="+this.Filter_To+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((function(t){e.transfers=t.data.transfers,e.warehouses=t.data.warehouses,e.totalRows=t.data.totalRows,n.a.done(),e.isLoading=!1})).catch((function(t){n.a.done(),setTimeout((function(){e.isLoading=!1}),500)}))},showDetails:function(t){var e=this;n.a.start(),n.a.set(.1),axios.get("transfers/"+t).then((function(t){e.transfer=t.data.transfer,e.details=t.data.details,Fire.$emit("Get_Details_Transfer")})).catch((function(t){Fire.$emit("Get_Details_Transfer")}))},Transfer_PDF:function(){var t=new i.default("p","pt");t.autoTable([{title:"Ref",dataKey:"Ref"},{title:"From warehouse",dataKey:"from_warehouse"},{title:"To warehouse",dataKey:"to_warehouse"},{title:"Total Products",dataKey:"items"},{title:"Status",dataKey:"statut"}],this.transfers),t.text("Transfer List",40,25),t.save("Transfer_List.pdf")},Transfer_Excel:function(){n.a.start(),n.a.set(.1),axios.get("transfers/export/Excel",{responseType:"blob",headers:{"Content-Type":"application/json"}}).then((function(t){var e=window.URL.createObjectURL(new Blob([t.data])),s=document.createElement("a");s.href=e,s.setAttribute("download","List_Transfers.xlsx"),document.body.appendChild(s),s.click(),setTimeout((function(){return n.a.done()}),500)})).catch((function(){setTimeout((function(){return n.a.done()}),500)}))},Remove_Transfer:function(t){var e=this;this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((function(s){s.value&&(n.a.start(),n.a.set(.1),axios.delete("transfers/"+t).then((function(){e.$swal(e.$t("Delete.Deleted"),e.$t("Delete.TitleTransfer"),"success"),Fire.$emit("Delete_Transfer")})).catch((function(){setTimeout((function(){return n.a.done()}),500),e.$swal(e.$t("Delete.Failed"),e.$t("Delete.Therewassomethingwronge"),"warning")})))}))},delete_by_selected:function(){var t=this;this.$swal({title:this.$t("Delete.Title"),text:this.$t("Delete.Text"),type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",cancelButtonText:this.$t("Delete.cancelButtonText"),confirmButtonText:this.$t("Delete.confirmButtonText")}).then((function(e){e.value&&(n.a.start(),n.a.set(.1),axios.post("transfers/delete/by_selection",{selectedIds:t.selectedIds}).then((function(){t.$swal(t.$t("Delete.Deleted"),t.$t("Delete.TitleTransfer"),"success"),Fire.$emit("Delete_Transfer")})).catch((function(){setTimeout((function(){return n.a.done()}),500),t.$swal(t.$t("Delete.Failed"),t.$t("Delete.Therewassomethingwronge"),"warning")})))}))}},created:function(){var t=this;this.Get_Transfers(1),Fire.$on("Get_Details_Transfer",(function(){t.$bvModal.show("showDetails"),setTimeout((function(){return n.a.done()}),500)})),Fire.$on("Delete_Transfer",(function(){setTimeout((function(){t.Get_Transfers(t.serverParams.page),setTimeout((function(){return n.a.done()}),500)}),500)}))}},d=s(2),f=Object(d.a)(u,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main-content"},[s("breadcumb",{attrs:{page:t.$t("ListTransfers"),folder:t.$t("StockTransfers")}}),t._v(" "),t.isLoading?s("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):s("div",[s("vue-good-table",{attrs:{mode:"remote",columns:t.columns,totalRows:t.totalRows,rows:t.transfers,"search-options":{enabled:!0,placeholder:t.$t("Search_this_table")},"select-options":{enabled:!0,clearSelectionText:""},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"tableOne table-hover vgt-table"},on:{"on-page-change":t.onPageChange,"on-per-page-change":t.onPerPageChange,"on-sort-change":t.onSortChange,"on-search":t.onSearch,"on-selected-rows-change":t.selectionChanged},scopedSlots:t._u([{key:"table-row",fn:function(e){return["actions"==e.column.field?s("span",[s("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"View"},on:{click:function(s){return t.showDetails(e.row.id)}}},[s("i",{staticClass:"i-Eye text-25 text-info"})]),t._v(" "),t.currentUserPermissions&&t.currentUserPermissions.includes("transfer_edit")?s("router-link",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Edit",to:{name:"edit_transfer",params:{id:e.row.id}}}},[s("i",{staticClass:"i-Edit text-25 text-success"})]):t._e(),t._v(" "),t.currentUserPermissions&&t.currentUserPermissions.includes("transfer_delete")?s("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{title:"Delete"},on:{click:function(s){return t.Remove_Transfer(e.row.id)}}},[s("i",{staticClass:"i-Close-Window text-25 text-danger"})]):t._e()],1):"statut"==e.column.field?s("div",["completed"==e.row.statut?s("span",{staticClass:"badge badge-outline-success"},[t._v(t._s(t.$t("complete")))]):"sent"==e.row.statut?s("span",{staticClass:"badge badge-outline-warning"},[t._v(t._s(t.$t("Sent")))]):s("span",{staticClass:"badge badge-outline-danger"},[t._v(t._s(t.$t("Pending")))])]):t._e()]}}])},[s("div",{attrs:{slot:"selected-row-actions"},slot:"selected-row-actions"},[s("button",{staticClass:"btn btn-danger btn-sm",on:{click:function(e){return t.delete_by_selected()}}},[t._v(t._s(t.$t("Del")))])]),t._v(" "),s("div",{staticClass:"mt-2 mb-3",attrs:{slot:"table-actions"},slot:"table-actions"},[s("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-right",modifiers:{"sidebar-right":!0}}],attrs:{variant:"outline-info ripple m-1",size:"sm"}},[s("i",{staticClass:"i-Filter-2"}),t._v("\n          "+t._s(t.$t("Filter"))+"\n        ")]),t._v(" "),s("b-button",{attrs:{size:"sm",variant:"outline-success ripple m-1"},on:{click:function(e){return t.Transfer_PDF()}}},[s("i",{staticClass:"i-File-Copy"}),t._v(" PDF\n        ")]),t._v(" "),s("b-button",{attrs:{size:"sm",variant:"outline-danger ripple m-1"},on:{click:function(e){return t.Transfer_Excel()}}},[s("i",{staticClass:"i-File-Excel"}),t._v(" EXCEL\n        ")]),t._v(" "),t.currentUserPermissions&&t.currentUserPermissions.includes("transfer_add")?s("router-link",{staticClass:"btn-sm btn btn-primary ripple btn-icon m-1",attrs:{to:"/app/transfers/store"}},[s("span",{staticClass:"ul-btn__icon"},[s("i",{staticClass:"i-Add"})]),t._v(" "),s("span",{staticClass:"ul-btn__text ml-1"},[t._v(t._s(t.$t("Add")))])]):t._e()],1)])],1),t._v(" "),s("b-sidebar",{attrs:{id:"sidebar-right",title:t.$t("Filter"),"bg-variant":"white",right:"",shadow:""}},[s("div",{staticClass:"px-3 py-2"},[s("b-row",[s("b-col",{attrs:{md:"12"}},[s("b-form-group",{attrs:{label:t.$t("Reference")}},[s("b-form-input",{attrs:{label:"Reference",placeholder:t.$t("Reference")},model:{value:t.Filter_Ref,callback:function(e){t.Filter_Ref=e},expression:"Filter_Ref"}})],1)],1),t._v(" "),s("b-col",{attrs:{md:"12"}},[s("b-form-group",{attrs:{label:t.$t("FromWarehouse")}},[s("v-select",{attrs:{reduce:function(t){return t.value},placeholder:t.$t("Choose_Warehouse"),options:t.warehouses.map((function(t){return{label:t.name,value:t.id}}))},model:{value:t.Filter_From,callback:function(e){t.Filter_From=e},expression:"Filter_From"}})],1)],1),t._v(" "),s("b-col",{attrs:{md:"12"}},[s("b-form-group",{attrs:{label:t.$t("ToWarehouse")}},[s("v-select",{attrs:{reduce:function(t){return t.value},placeholder:t.$t("Choose_Warehouse"),options:t.warehouses.map((function(t){return{label:t.name,value:t.id}}))},model:{value:t.Filter_To,callback:function(e){t.Filter_To=e},expression:"Filter_To"}})],1)],1),t._v(" "),s("b-col",{attrs:{md:"12"}},[s("b-form-group",{attrs:{label:t.$t("Status")}},[s("v-select",{attrs:{reduce:function(t){return t.value},placeholder:t.$t("Choose_Status"),options:[{label:"Completed",value:"completed"},{label:"Sent",value:"sent"},{label:"Pending",value:"pending"}]},model:{value:t.Filter_status,callback:function(e){t.Filter_status=e},expression:"Filter_status"}})],1)],1),t._v(" "),s("b-col",{attrs:{md:"6",sm:"12"}},[s("b-button",{attrs:{variant:"primary ripple m-1",size:"sm",block:""},on:{click:function(e){return t.Get_Transfers(t.serverParams.page)}}},[s("i",{staticClass:"i-Filter-2"}),t._v("\n            "+t._s(t.$t("Filter"))+"\n          ")])],1),t._v(" "),s("b-col",{attrs:{md:"6",sm:"12"}},[s("b-button",{attrs:{variant:"danger ripple m-1",size:"sm",block:""},on:{click:function(e){return t.Reset_Filter()}}},[s("i",{staticClass:"i-Power-2"}),t._v("\n            "+t._s(t.$t("Reset"))+"\n          ")])],1)],1)],1)]),t._v(" "),s("b-modal",{attrs:{"ok-only":"",size:"lg",id:"showDetails",title:t.$t("TransferDetail")}},[s("b-row",[s("b-col",{staticClass:"mt-3",attrs:{lg:"5",md:"12",sm:"12"}},[s("table",{staticClass:"table table-hover table-bordered table-sm"},[s("tbody",[s("tr",[s("td",[t._v(t._s(t.$t("date")))]),t._v(" "),s("th",[t._v(t._s(t.transfer.date))])]),t._v(" "),s("tr",[s("td",[t._v(t._s(t.$t("Reference")))]),t._v(" "),s("th",[t._v(t._s(t.transfer.Ref))])]),t._v(" "),s("tr",[s("td",[t._v(t._s(t.$t("FromWarehouse")))]),t._v(" "),s("th",[t._v(t._s(t.transfer.from_warehouse))])]),t._v(" "),s("tr",[s("td",[t._v(t._s(t.$t("ToWarehouse")))]),t._v(" "),s("th",[t._v(t._s(t.transfer.to_warehouse))])]),t._v(" "),s("tr",[s("td",[t._v(t._s(t.$t("Total")))]),t._v(" "),s("th",[t._v(t._s(t.currentUser.currency)+t._s(t.formatNumber(t.transfer.GrandTotal,2)))])]),t._v(" "),s("tr",[s("td",[t._v(t._s(t.$t("Status")))]),t._v(" "),s("th",["completed"==t.transfer.statut?s("span",{staticClass:"badge badge-outline-success"},[t._v(t._s(t.$t("complete")))]):"sent"==t.transfer.statut?s("span",{staticClass:"badge badge-outline-warning"},[t._v(t._s(t.$t("Sent")))]):s("span",{staticClass:"badge badge-outline-danger"},[t._v(t._s(t.$t("Pending")))])])])])])]),t._v(" "),s("b-col",{staticClass:"mt-3",attrs:{lg:"7",md:"12",sm:"12"}},[s("div",{staticClass:"table-responsive"},[s("table",{staticClass:"table table-hover table-bordered table-sm"},[s("thead",[s("tr",[s("th",{attrs:{scope:"col"}},[t._v(t._s(t.$t("ProductName")))]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v(t._s(t.$t("CodeProduct")))]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v(t._s(t.$t("Quantity")))]),t._v(" "),s("th",{attrs:{scope:"col"}},[t._v(t._s(t.$t("SubTotal")))])])]),t._v(" "),s("tbody",t._l(t.details,(function(e){return s("tr",[s("td",[t._v(t._s(e.name))]),t._v(" "),s("td",[t._v(t._s(e.code))]),t._v(" "),s("td",[t._v(t._s(t.formatNumber(e.quantity,2))+" "+t._s(e.unit))]),t._v(" "),s("td",[t._v(t._s(t.currentUser.currency)+" "+t._s(e.total.toFixed(2)))])])})),0)])])])],1),t._v(" "),s("hr",{directives:[{name:"show",rawName:"v-show",value:t.transfer.note,expression:"transfer.note"}]}),t._v(" "),s("b-row",{staticClass:"mt-4"},[s("b-col",{attrs:{md:"12"}},[s("p",[t._v(t._s(t.transfer.note))])])],1)],1)],1)}),[],!1,null,null,null);e.default=f.exports}}]);