(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{1102:function(t,e,a){"use strict";a.r(e);var s=a(0),r=a.n(s),i=a(8),l=(a(17),{metaInfo:{title:"Report Purchases"},data:function(){return{isLoading:!0,serverParams:{sort:{field:"id",type:"desc"},page:1,perPage:10},limit:"10",search:"",totalRows:"",Filter_Supplier:"",Filter_status:"",Filter_Payment:"",Filter_Ref:"",Filter_date:"",suppliers:[],purchases:[]}},computed:{columns:function(){return[{label:this.$t("date"),field:"date",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Reference"),field:"Ref",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Supplier"),field:"provider_name",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Status"),field:"statut",html:!0,tdClass:"text-left",thClass:"text-left"},{label:this.$t("Total"),field:"GrandTotal",type:"decimal",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Paid"),field:"paid_amount",type:"decimal",tdClass:"text-left",thClass:"text-left"},{label:this.$t("Due"),field:"due",type:"decimal",tdClass:"text-left",thClass:"text-left"},{label:this.$t("PaymentStatus"),field:"payment_status",html:!0,tdClass:"text-left",thClass:"text-left"}]}},methods:{updateParams:function(t){this.serverParams=Object.assign({},this.serverParams,t)},onPageChange:function(t){var e=t.currentPage;this.serverParams.page!==e&&(this.updateParams({page:e}),this.Get_Purchases(e))},onPerPageChange:function(t){var e=t.currentPerPage;this.limit!==e&&(this.limit=e,this.updateParams({page:1,perPage:e}),this.Get_Purchases(1))},onSortChange:function(t){var e="";e="provider_name"==t[0].field?"provider_id":t[0].field,this.updateParams({sort:{type:t[0].type,field:e}}),this.Get_Purchases(this.serverParams.page)},onSearch:function(t){this.search=t.searchTerm,this.Get_Purchases(this.serverParams.page)},Reset_Filter:function(){this.search="",this.Filter_Supplier="",this.Filter_status="",this.Filter_Payment="",this.Filter_Ref="",this.Filter_date="",this.Get_Purchases(this.serverParams.page)},Purchase_PDF:function(){var t=new i.default("p","pt");t.autoTable([{title:"Ref",dataKey:"Ref"},{title:"Provider",dataKey:"provider_name"},{title:"Status",dataKey:"statut"},{title:"Total",dataKey:"GrandTotal"},{title:"Paid",dataKey:"paid_amount"},{title:"Due",dataKey:"due"},{title:"Status Payment",dataKey:"payment_status"}],this.purchases),t.text("Purchase report",40,25),t.save("Purchase_report.pdf")},Purchase_Excel:function(){r.a.start(),r.a.set(.1),axios.get("purchases/export/Excel",{responseType:"blob",headers:{"Content-Type":"application/json"}}).then((function(t){var e=window.URL.createObjectURL(new Blob([t.data])),a=document.createElement("a");a.href=e,a.setAttribute("download","List_Purchases.xlsx"),document.body.appendChild(a),a.click(),r.a.done()})).catch((function(){r.a.done()}))},setToStrings:function(){null===this.Filter_Supplier&&(this.Filter_Supplier="")},Get_Purchases:function(t){var e=this;r.a.start(),r.a.set(.1),this.setToStrings(),axios.get("/report/Purchases?page="+t+"&Ref="+this.Filter_Ref+"&date="+this.Filter_date+"&provider_id="+this.Filter_Supplier+"&statut="+this.Filter_status+"&payment_statut="+this.Filter_Payment+"&SortField="+this.serverParams.sort.field+"&SortType="+this.serverParams.sort.type+"&search="+this.search+"&limit="+this.limit).then((function(t){e.purchases=t.data.purchases,e.suppliers=t.data.suppliers,e.totalRows=t.data.totalRows,r.a.done(),e.isLoading=!1})).catch((function(t){r.a.done(),setTimeout((function(){e.isLoading=!1}),500)}))},formatNumber:function(t,e){var a=("string"==typeof t?t:t.toString()).split(".");if(e<=0)return a[0];var s=a[1]||"";if(s.length>e)return"".concat(a[0],".").concat(s.substr(0,e));for(;s.length<e;)s+="0";return"".concat(a[0],".").concat(s)}},created:function(){this.Get_Purchases(1)}}),n=a(2),o=Object(n.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main-content"},[a("breadcumb",{attrs:{page:t.$t("PurchasesReport"),folder:t.$t("Reports")}}),t._v(" "),t.isLoading?a("div",{staticClass:"loading_page spinner spinner-primary mr-3"}):t._e(),t._v(" "),t.isLoading?t._e():a("b-card",{staticClass:"wrapper"},[a("vue-good-table",{attrs:{mode:"remote",columns:t.columns,totalRows:t.totalRows,rows:t.purchases,"search-options":{placeholder:t.$t("Search_this_table"),enabled:!0},"pagination-options":{enabled:!0,mode:"records",nextLabel:"next",prevLabel:"prev"},styleClass:"order-table vgt-table"},on:{"on-page-change":t.onPageChange,"on-per-page-change":t.onPerPageChange,"on-sort-change":t.onSortChange,"on-search":t.onSearch},scopedSlots:t._u([{key:"table-row",fn:function(e){return["statut"==e.column.field?a("div",["received"==e.row.statut?a("span",{staticClass:"badge badge-outline-success"},[t._v(t._s(t.$t("Received")))]):"pending"==e.row.statut?a("span",{staticClass:"badge badge-outline-info"},[t._v(t._s(t.$t("Pending")))]):a("span",{staticClass:"badge badge-outline-warning"},[t._v(t._s(t.$t("Ordered")))])]):"payment_status"==e.column.field?a("div",["paid"==e.row.payment_status?a("span",{staticClass:"badge badge-outline-success"},[t._v(t._s(t.$t("Paid")))]):"partial"==e.row.payment_status?a("span",{staticClass:"badge badge-outline-primary"},[t._v(t._s(t.$t("partial")))]):a("span",{staticClass:"badge badge-outline-warning"},[t._v(t._s(t.$t("Unpaid")))])]):t._e()]}}],null,!1,3596438109)},[a("div",{staticClass:"mt-2 mb-3",attrs:{slot:"table-actions"},slot:"table-actions"},[a("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.sidebar-right",modifiers:{"sidebar-right":!0}}],attrs:{variant:"outline-info ripple m-1",size:"sm"}},[a("i",{staticClass:"i-Filter-2"}),t._v("\n          "+t._s(t.$t("Filter"))+"\n        ")]),t._v(" "),a("b-button",{attrs:{size:"sm",variant:"outline-success ripple m-1"},on:{click:function(e){return t.Purchase_PDF()}}},[a("i",{staticClass:"i-File-Copy"}),t._v(" PDF\n        ")]),t._v(" "),a("b-button",{attrs:{size:"sm",variant:"outline-danger ripple m-1"},on:{click:function(e){return t.Purchase_Excel()}}},[a("i",{staticClass:"i-File-Excel"}),t._v(" EXCEL\n        ")])],1)])],1),t._v(" "),a("b-sidebar",{attrs:{id:"sidebar-right",title:t.$t("Filter"),"bg-variant":"white",right:"",shadow:""}},[a("div",{staticClass:"px-3 py-2"},[a("b-row",[a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:t.$t("date")}},[a("b-form-input",{attrs:{type:"date"},model:{value:t.Filter_date,callback:function(e){t.Filter_date=e},expression:"Filter_date"}})],1)],1),t._v(" "),a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:t.$t("Reference")}},[a("b-form-input",{attrs:{label:"Reference",placeholder:t.$t("Reference")},model:{value:t.Filter_Ref,callback:function(e){t.Filter_Ref=e},expression:"Filter_Ref"}})],1)],1),t._v(" "),a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:t.$t("Supplier")}},[a("v-select",{attrs:{reduce:function(t){return t.value},placeholder:t.$t("Choose_Supplier"),options:t.suppliers.map((function(t){return{label:t.name,value:t.id}}))},model:{value:t.Filter_Supplier,callback:function(e){t.Filter_Supplier=e},expression:"Filter_Supplier"}})],1)],1),t._v(" "),a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:t.$t("Status")}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.Filter_status,expression:"Filter_status"}],staticClass:"form-control",attrs:{type:"text"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.Filter_status=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",selected:""}},[t._v("All")]),t._v(" "),a("option",{attrs:{value:"received"}},[t._v("Received")]),t._v(" "),a("option",{attrs:{value:"pending"}},[t._v("Pending")]),t._v(" "),a("option",{attrs:{value:"ordered"}},[t._v("Ordered")])])])],1),t._v(" "),a("b-col",{attrs:{md:"12"}},[a("b-form-group",{attrs:{label:t.$t("PaymentStatus")}},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.Filter_Payment,expression:"Filter_Payment"}],staticClass:"form-control",attrs:{type:"text"},on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.Filter_Payment=e.target.multiple?a:a[0]}}},[a("option",{attrs:{value:"",selected:""}},[t._v("All")]),t._v(" "),a("option",{attrs:{value:"paid"}},[t._v("Paid")]),t._v(" "),a("option",{attrs:{value:"partial"}},[t._v("partial")]),t._v(" "),a("option",{attrs:{value:"unpaid"}},[t._v("UnPaid")])])])],1),t._v(" "),a("b-col",{attrs:{md:"6",sm:"12"}},[a("b-button",{attrs:{variant:"primary ripple m-1",size:"sm",block:""},on:{click:function(e){return t.Get_Purchases(t.serverParams.page)}}},[a("i",{staticClass:"i-Filter-2"}),t._v("\n            "+t._s(t.$t("Filter"))+"\n          ")])],1),t._v(" "),a("b-col",{attrs:{md:"6",sm:"12"}},[a("b-button",{attrs:{variant:"danger ripple m-1",size:"sm",block:""},on:{click:function(e){return t.Reset_Filter()}}},[a("i",{staticClass:"i-Power-2"}),t._v("\n            "+t._s(t.$t("Reset"))+"\n          ")])],1)],1)],1)])],1)}),[],!1,null,null,null);e.default=o.exports}}]);